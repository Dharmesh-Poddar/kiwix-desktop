<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">
<html>
<head>
<script src="qrc:///js/vue.js"></script>
<script src="qrc:///qtwebchannel/qwebchannel.js"></script>
<script src="qrc:///js/_contentManager.js"></script>
<link rel="stylesheet" type="text/css" href="qrc:///css/_contentManager.css"/>
</head>
<body onload="init()">
<div id="app">
  <div id="searchBar">
    <form>
      <input id="searchInput" type="text" placeholder="Search files" oninput="setSearch(this.value)"/>
    </form>
  </div>
  <div id="bookTable">
    <div class="header">
      <span class="tablecell cell0"></span>
      <span v-on:click="sortBookBy('title')" :class="{ sortableBold: isActive('title') }" class="tablecell cell1 sortable"><i :class="{ arrowDown: isUpOrDown('title-asc'), arrowUp: isUpOrDown('title-desc') }"></i> File name</span>
      <span v-on:click="sortBookBy('size')" :class="{ sortableBold: isActive('size') }" class="tablecell cell2 sortable"><i :class="{ arrowDown: isUpOrDown('size-asc'), arrowUp: isUpOrDown('size-desc') }"></i> Size</span>
      <span v-on:click="sortBookBy('date')" :class="{ sortableBold: isActive('date') }" class="tablecell cell3 sortable"><i :class="{ arrowDown: isUpOrDown('date-asc'), arrowUp: isUpOrDown('date-desc') }"></i> Date</span>
      <span class="tablecell cell4">Content type</span>
      <span class="tablecell cell5 tablerow">
          <button v-on:click="resetSort()">reset sort</button>
      </span>
    </div>
    <div id="load-icon" class="loader"></div>
    <div id="bookList" onscroll=scrolled(this)>
      <div id="menu" class="menu">
        <ul class="menu-options local-option">
          <li v-on:click="eraseBook(getBookFromMousePosition())" class="menu-option">Delete</li>
        </ul>
      </div>
      <details v-for="book in displayedBooks(books, displayedBooksNb)" class="book">
        <summary v-bind:id="book.id" class="tablerow book-summary">
          <span class="tablecell cell0">
            <img v-if="book.faviconUrl" v-bind:src="'http://' + book.faviconUrl" />
            <img v-else-if="book.faviconMimeType" v-bind:src="'zim://' + book.id + '.favicon.meta'" />
          </span>
          <span class="tablecell cell1">
            {{ book.title }}
          </span>
          <span class="tablecell cell2">
            {{ niceBytes(book.size) }}
          </span>
          <span class="tablecell cell3">
            {{ book.date }}
          </span>
          <span class="tablecell cell4">
            {{ book.tags }}
          </span>
          <span class="tablecell cell5">
            <template v-if="downloads[book.id]">
              <span>
                {{ niceBytes(downloads[book.id].completedLength) }} / {{ niceBytes(downloads[book.id].totalLength) }}
              </span>
            </template>
          </span>
          <span class="tablecell cell5">
            <button v-if="book.path" v-on:click="openBook(book)">Open</button>
            <button v-if="!book.path && !downloads[book.id]" v-on:click="downloadBook(book)">Download</button>
            <button v-if="downloads[book.id] && downloads[book.id].status == 'active'" v-on:click="pauseBook(book)">Pause</button>
            <button v-if="downloads[book.id] && downloads[book.id].status == 'paused'" v-on:click="resumeBook(book)">Resume</button>
          </span>
          <span v-if="downloads[book.id]" class="tablecell cell5">
            <button v-on:click="cancelBook(book)">Cancel</button>
          </span>
        </summary>
        <p class="content">
          {{ book.description }}
        </p>
      </details>
    </div>
  </div>
</div>
</body></html>
